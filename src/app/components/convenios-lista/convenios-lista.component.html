<div class="convenios-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">üìã Convenios de Recaudo</h1>
      <p class="page-subtitle">Gesti√≥n de convenios configurados</p>
    </div>
    <div class="header-actions">
      <button class="btn-nuevo" (click)="nuevoConvenio()">
        <span class="btn-icon">‚ûï</span>
        <span class="btn-text">Nuevo Convenio</span>
      </button>
      <button class="btn-recargar" (click)="recargar()" [disabled]="isLoading">
        <span class="btn-icon">üîÑ</span>
        <span class="btn-text">Recargar</span>
      </button>
    </div>
  </div>



  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p class="loading-text">Cargando convenios...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error-container">
    <div class="error-icon">‚ö†Ô∏è</div>
    <h3 class="error-title">Error al cargar convenios</h3>
    <p class="error-message">{{ error }}</p>
    <button class="btn-retry" (click)="recargar()">Reintentar</button>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && !error && convenios.length === 0" class="empty-container">
    <div class="empty-icon">üìù</div>
    <h3 class="empty-title">No hay convenios configurados</h3>
    <p class="empty-message">Comience creando su primer convenio de recaudo</p>
    <button class="btn-crear-primero" (click)="nuevoConvenio()">
      <span class="btn-icon">‚ûï</span>
      <span class="btn-text">Crear Primer Convenio</span>
    </button>
  </div>

  <!-- Convenios List -->
  <div *ngIf="!isLoading && !error && convenios.length > 0" class="convenios-content">
    <!-- Stats Bar -->
    <div class="stats-bar">
      <div class="stat-item">
        <span class="stat-label">Total:</span>
        <span class="stat-value">{{ totalRegistros }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">P√°gina:</span>
        <span class="stat-value">{{ paginaActual }} de {{ totalPaginas }}</span>
      </div>
    </div>

    <!-- Convenios Grid -->
    <div class="convenios-grid">
      <div *ngFor="let convenio of convenios; trackBy: trackByConvenio" class="convenio-card">

        <!-- Card Header -->
        <div class="card-header">
          <div class="convenio-info">
            <h3 class="convenio-nombre">{{ convenio.nombre || 'Convenio #' + convenio.id }}</h3>
            <span class="convenio-fecha">{{ convenio.fechaCreacion | date:'dd/MM/yyyy' }}</span>
          </div>
          <div class="convenio-status" [class]="getStatusClass(convenio.estado)">
            {{ convenio.estado || 'Activo' }}
          </div>
        </div>

        <!-- Card Body -->
        <div class="card-body">
          <div class="convenio-details">
            <div class="detail-item" *ngIf="convenio.recaudo">
              <span class="detail-label">Recaudo:</span>
              <span class="detail-value">{{ convenio.recaudo.nombre }}</span>
            </div>
            <div class="detail-item" *ngIf="convenio.ambitos">
              <span class="detail-label">√Åmbitos:</span>
              <span class="detail-value">{{ convenio.ambitos.length }} configurados</span>
            </div>
            <div class="detail-item" *ngIf="convenio.excepciones">
              <span class="detail-label">Excepciones:</span>
              <span class="detail-value">{{ convenio.excepciones.length }} configuradas</span>
            </div>
            <div class="detail-item" *ngIf="convenio.programas">
              <span class="detail-label">Programas:</span>
              <span class="detail-value">{{ convenio.programas.length }} configurados</span>
            </div>
          </div>
        </div>

        <!-- Card Actions -->
        <div class="card-actions">
          <button class="btn-action btn-ver" (click)="verDetalles(convenio)">
            <span class="btn-icon">üëÅÔ∏è</span>
            <span class="btn-text">Ver</span>
          </button>
          <button class="btn-action btn-editar" (click)="editarConvenio(convenio)">
            <span class="btn-icon">‚úèÔ∏è</span>
            <span class="btn-text">Editar</span>
          </button>

        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination-container" *ngIf="totalPaginas > 1">
      <div class="pagination">
        <button class="page-btn" [disabled]="paginaActual === 1" (click)="paginaAnterior()">
          ‚Üê Anterior
        </button>

        <div class="page-numbers">
          <button *ngFor="let pagina of getPaginasVisibles()" class="page-number"
            [class.active]="pagina === paginaActual" (click)="irAPagina(pagina)">
            {{ pagina }}
          </button>
        </div>

        <button class="page-btn" [disabled]="paginaActual === totalPaginas" (click)="paginaSiguiente()">
          Siguiente ‚Üí
        </button>
      </div>
    </div>
  </div>
</div>


<div id="Main_PanelFiltros">

  <div class="col-lg-12">
    <div class="card">
      <div class="card-header align-items-center d-flex">
        <h4 class="card-title mb-0 flex-grow-1 btn-outline-primary"><strong>Filtros</strong></h4>

      </div>
      <div class="card-body">

        <div class="row" data-select2-id="6">




          <div class="col-md-6 col-sm-12">
            <div class="form-group">
              <label for="txtNombre">Nombre Convenio:</label>
              <input name="ctl00$Main$txtNombre" type="text"
                onchange="javascript:setTimeout('__doPostBack(\'ctl00$Main$txtNombre\',\'\')', 0)"
                onkeypress="if (WebForm_TextBoxKeyHandler(event) == false) return false;" id="Main_txtNombre"
                class="form-control">
            </div>
          </div>

          <div class="col-md-6 col-sm-12" data-select2-id="5">
            <div class="form-group" data-select2-id="4">
              <label for="ddlTipo">Tipo Convenio:</label>
              <select name="ctl00$Main$ddl_TipoConvenio"
                onchange="javascript:setTimeout('__doPostBack(\'ctl00$Main$ddl_TipoConvenio\',\'\')', 0)"
                id="Main_ddl_TipoConvenio"
                class="form-control select2 w-100 select2-container select2-container--bootstrap4 select2-container--below select2-hidden-accessible"
                style="width: 100%" data-select2-id="Main_ddl_TipoConvenio" tabindex="-1" aria-hidden="true">
                <option selected="selected" value="0" data-select2-id="2">Seleccione una opci√≥n</option>
                <option value="389" data-select2-id="15">Dependiente con complementariedad</option>
                <option value="388" data-select2-id="16">Dependiente sin complementariedad</option>
                <option value="387" data-select2-id="17">Independiente</option>
                <option value="390" data-select2-id="18">Mixto</option>

              </select><span
                class="select2 select2-container select2-container--bootstrap4 select2-container--focus select2-container--above"
                dir="ltr" data-select2-id="1" style="width: 100%;"><span class="selection"><span
                    class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true"
                    aria-expanded="false" tabindex="0" aria-disabled="false"
                    aria-labelledby="select2-Main_ddl_TipoConvenio-container"><span class="select2-selection__rendered"
                      id="select2-Main_ddl_TipoConvenio-container" role="textbox" aria-readonly="true"
                      title="Seleccione una opci√≥n">Seleccione una opci√≥n</span><span class="select2-selection__arrow"
                      role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper"
                  aria-hidden="true"></span></span>
            </div>
          </div>



        </div>
      </div>
    </div>
  </div>

</div>